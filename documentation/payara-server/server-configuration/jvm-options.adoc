[[configurable-jdk-versions-jvm-options]]
= Configurable JDK Versions for JVM Options

_Since Payara Server 5.182_

It is possible to allow specific JVM options configured for a Payara Server instance to be applied only on specific JDK versions. The configuration is flexible since it allows the user to define minimum and maximum versions of all JDKs upon which each JVM option should be applied.

NOTE: If no minimum and/or maximum JDK versions are set for a particular JVM option, it shall be applied no matter which JDK is being used to run the server's instance (which is the default behaviour).

[[versioning-syntax]]
== Versioning Syntax

JDK versions must follow standard the standard JDK versioning scheme (`1.$MAJOR.$MINOR.$UPDATE`). The syntax that can be used is a bit flexible, allowing the following variants to be correctly interpreted:

* `1.8.0.162`
* `1.8.0u162`
* `1.8.0`
* `1.8`

[[]]
== Configuring JDK Versions

JDK Versions for JVM Options can be configured in three different ways: Using the admin console, running asadmin commands or directly editing the _domain.xml_ configuration file.

[[using-admin-console]]
=== Using the Admin Console

To configure the JDK versions for JVM options in the admin console, head to the *Configurations -> <instance configuration> -> JVM Settings* and on the *JVM Options* tab specify the versions in the table:

image::/images/jvm-options/configure-jdk-versions-admin-console.png[Configure JDK versions for JVM options in Admin console]

You can omit either the minimum or maximum versions by leaving the fields blank.

[[using-asadmin-commands]]
=== Using Asadmin commands

The `create-jvm-options` asadmin command has been modified to set the miminum and maximum JDK versions in the following ways:

. Use the `--min-jvm` and `--max-jvm` arguments to set the versions when running the command:
+
[source, shell]
----
asadmin create-jvm-options --target=server-config --min-jvm=1.8.0u162 -Djava.awt.headless\=true

asadmin create-jvm-options --target=server-config --max-jvm=1.8.0u172 -XX\:+UnlockDiagnosticVMOptions
----
+
NOTE: When using these arguments to set multiple JVM options, the specified versions will be applied for each option.

. Specify the versions using the `[MIN_VERSION | MAX_VERSION]` text syntax for the inclusive version range before each JVM option:
+
[source, shell]
----
asadmin create-jvm-options --target=server-config [1.8.0u162|]-Djava.awt.headless\=true

asadmin create-jvm-options --target=server-config [|1.8.0u172]-XX\:+UnlockDiagnosticVMOptions

asadmin create-jvm-options --target=server-config [1.8.0u168|1.8.0u172]-XX\:NewRatio\=2
----
+
You can specify the range for each JVM option when specifying multiple options too:
+
[source, shell]
----
asadmin create-jvm-options --target=server-config -Djava.awt.headless\=true:[|1.8.0u172]-XX\:+UnlockDiagnosticVMOptions:[1.8.0u168|1.8.0u172]-XX\:NewRatio\=2
----

[[editing-domain-xml-file]]
=== Editing the _domain.xml_ configuration file

To configure the JDK versions in the _domain.xml_ configuration file, locate the `<java-config>` element first and prefix the correspondent JVM options with the respective `[MIN_VERSION | MAX_VERSION]` text for the version range inside the `<jvm-options>` sub-element like this:

[source, xml]
----
<java-config classpath-suffix="" debug-options="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=9009" system-classpath="">
        ...
        <jvm-options>[|1.8.0.172]-Djdk.corba.allowOutputStreamSubclass=true</jvm-options>
        <jvm-options>[1.8.0.162|]-Djava.awt.headless=true</jvm-options>
        <jvm-options>-Xmx512m</jvm-options>
      </java-config>
----

WARNING: Modifying the _domain.xml_ configuration is not a supported configuration method, so be careful when considering this option.